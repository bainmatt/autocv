---
title: "An example resume generated with autocv"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{An example resume generated with autocv}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r}
library(autocv)
```

# A reproducible example

The following end-to-end example runs in a temporary environment on your
local machine, constructing a project directory, an application directory,
a resume, and keyword reports, all from the `autocv`-supplied
example job posting, template datasets, and template stylesheets.

```{r reproducible-demo, eval=FALSE}
autocv::in_tmp_env({
  message("1. Build the project directory...")
  autocv::build_base_directory()
  
  data(example_job_metadata)
  app_df <- autocv::construct_app_metadata(app_info = example_job_metadata)

  message("")
  message("2. Build the application...")
  autocv::build_app_directory(app_df = app_df, open = FALSE)
  
  message("")
  message("3. Render the application...")
  # autocv::render_app(cover = FALSE, email = FALSE)
  autocv::render_resume_plain()

  message("")
  message("4. Check application keywords...")
  report_df <- autocv::check_skills()
  print(report_df)

  message("")
  message("5. Inspect application metadata...")
  app_df <- autocv::get_app_info()
  print(app_df)
})
```

In contrast to the above example, the following runs in a supplied directory
('output', in this case) relative to your project root.

This example is included as a complete step-by-step demo which outputs
documents and reports that you can review [here]().

```{r build-base}
# TODO: include each of the above with interleaved explanations

autocv::in_tmp_env({
  message("1. Build the project directory...")
  autocv::build_base_directory()
  
  data(example_job_metadata)
  app_df <- autocv::construct_app_metadata(app_info = example_job_metadata)
})

```

```{r build-app}
autocv::in_tmp_env({
  message("2. Build the application...")
  autocv::build_app_directory(app_df = app_df, open = FALSE)
})

```

```{r render-app}
autocv::in_tmp_env({
  message("3. Render the application...")
  # autocv::render_app(cover = FALSE, email = FALSE)
  autocv::render_resume_plain()
})

```

```{r check}
autocv::in_tmp_env({
  message("4. Check application keywords...")
  report_df <- autocv::check_skills()
  print(report_df)
})

```

```{r inspect}
autocv::in_tmp_env({
  message("5. Inspect application metadata...")
  app_df <- autocv::get_app_info()
  print(app_df)
})

```

```{r log-test}
autocv::in_tmp_env({
  resume_path <- autocv::get_app_info(
    id = "AB", field = "resume_plain_path"
  )$resume_plain_path
  
  print(fs::path_wd())
  
  # TODO: copy tmpenv output into repo in git-compat way) (fs::path_wd)
  target_path <- fs::path_wd()
  autocv::copy_files(
    source_paths = resume_path,
    target_paths = target_path
  )
})

```
